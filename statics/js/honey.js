/*
 * 这是一个热的不得了的日子
 * honey, just a loader, based headjs ( headjs.com )
 * version 2.0
 * 
 * mod 约定 *dir_modname*
 *  mod_dialog    mod/dialog.js ( mod/dialog.source.js )
 *  lib_jquery    lib/jquery.js ( mod/jquery.source.js )
 *
 * 文件被多次 honey.go 的处理 OK
 * IE等不能按顺序并行下载的浏览器 OK
 * IE等浏览器下combo合并 OK
 * 合并应该限制合成后文件大小 (  )
 * 如果是开发模式，自动引入 debug OK
 *
 */var PROJECT="photo-wall",VERSION="20120311",DEV=!1,COMBO=!1,COMBOURL="http://photowall.cnodejs.net/combo/",ROOT="http://photowall.cnodejs.net/";(function(a,b){function t(){v(f,function(a){a()})}function u(a,b){var c=o.trim(a);if(k[c])return k[c];var d=c.split("_"),e=(COMBO?"":ROOT)+d[0]+"/"+d[1]+(DEV?".source":"")+".js",f={name:c,src:e};return b||(k[c]=f),f}function v(a,b){if(!a)return;typeof a=="object"&&(a=[].slice.call(a));for(var c=0;c<a.length;c++)b.call(a,a[c],c)}function w(a){a=a||k;var b;for(var c in a)b=!a.hasOwnProperty(c)||a[c].state==s;return b}function x(a){if(a._done)return;a(),a._done=1}function y(a,b,c){var d=a||k,e=!1,f=[],h=[],i=COMBOURL+PROJECT+"/"+VERSION+"/?";for(var j in d)d[j].state!=s&&d[j].state!=r&&d[j].state!=q&&(f.push(j),h.push(d[j].src),d[j].state=!c&&r);return i+=h.join("&"),f=f.join(","),c?g[f]?g[f].state==p&&y(g[f].els,g[f].fn):(g[f]={state:q,fn:b,els:a},D({src:i,type:"cache"},function(){g[f].state=p,o.go(f,function(){b&&b.call()})})):(g[f]={state:r},D(i,function(){g[f].state=s,b&&b();for(var a in d)d[a].state=s,v(m[d[a].name],function(a){x(a)})})),o}function z(a,b){if(a.state==s)return b&&b();if(a.state==r)return o.ready(a.name,b);if(a.state==q)return a.onpreload.push(function(){z(a,b)});a.state=r,D(a.src,function(){a.state=s,b&&b(),v(m[a.name],function(a){x(a)}),w()&&j&&v(m.ALL,function(a){x(a)})})}function A(){for(var a in g)if(s!=g[a].state)return a;return!1}function B(a){a.state===undefined&&(a.state=q,a.onpreload=[],D({src:a.src,type:"cache"},function(){C(a)}))}function C(a){a.state=p,v(a.onpreload,function(a){a.call()})}function D(b,d){var e=a.createElement("script");e.type="text/"+(b.type||"javascript"),e.src=b.src||b,e.async=!1,e.onreadystatechange=e.onload=function(){var a=e.readyState;!d.done&&(!a||/loaded|complete/.test(a))&&(d.done=!0,d())},(a.body||c).appendChild(e)}function E(a){return Object.prototype.toString.call(a)=="[object Function]"}function F(){if(DEV&&!d)return;F.fired=!0,j||(j=!0,v(h,function(a){x(a)}))}var c=a.documentElement,d=!1,e=!0,f=[],g=[],h=[],i,j,k={},l=[],m={},k={},n=a.createElement("script").async===!0||"MozAppearance"in a.documentElement.style||window.opera,o=window.honey=window.HN=window.HN||function(){},p=1,q=2,r=3,s=4;o.go=n?function(a,c){var d={},g=c===b?!1:function(){e?c():f.push(c)},h=a.split(",");return v(h,function(a,b){a=u(a),d[a.name]=a,COMBO?COMBO&&b==h.length-1&&y(d,g):z(a,g&&b==h.length-1?function(){w(d)&&x(g)}:null)}),o}:function(a,c){var d={},e=c===b?!1:c,f=a.split(",");if(!i)return l.push(function(){o.go.call(null,a,c)}),o;if(COMBO)return A()?v(f,function(a,b){a=u(a,!0),d[a.name]=a,b==f.length-1&&y(d,e,!0)}):v(f,function(a,b){a=u(a),d[a.name]=a,b==f.length-1&&y(d,e)}),o;var g=f.shift();return f.length?(v(f,function(a){B(u(a))}),z(u(g),function(){o.go.call(null,f.join(","),e)})):z(u(g),e),o},o.ready=function(b,c){if(b==a)return j?x(c):h.push(c),o;E(b)&&(c=b,b="ALL");if(typeof b!="string"||!E(c))return o;var d=k[b];if(d&&d.state==s||b=="ALL"&&w()&&j)return x(c),o;var e=m[b];return e?e.push(c):e=m[b]=[c],o},o.def=function(a,b){E(a)?(b=a,a=[]):a=a.split(",");var c;while(a.length){c=o.trim(a.shift());if(!k[c]||s!=k[c].state)return e=!1,!n||COMBO?(alert(c+" is not required"),o):z(u(c),function(){e=!0,b(o),t()})}return b&&b(o),o},o.css=function(b){var d=a.createElement("link");d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href",b),(a.body||c).appendChild(d)},o.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};if(window.addEventListener)a.addEventListener("DOMContentLoaded",F,!1),window.addEventListener("load",F,!1);else if(window.attachEvent){a.attachEvent("onreadystatechange",function(){a.readyState==="complete"&&F()});var G=1;try{G=window.frameElement}catch(H){}!G&&c.doScroll&&function(){try{c.doScroll("left"),F()}catch(a){setTimeout(arguments.callee,1);return}}(),window.attachEvent("onload",F)}!a.readyState&&a.addEventListener&&(a.readyState="loading",a.addEventListener("DOMContentLoaded",handler=function(){a.removeEventListener("DOMContentLoaded",handler,!1),a.readyState="complete"},!1)),setTimeout(function(){i=!0,v(l,function(a){a()}),DEV&&D(ROOT+"honey.debug.js",function(){d=!0,o.debug("You are in the DEV mode!"),F.fired||F()})},300)})(document);